[meta]
name = "ros1_discovery"
version = "0.1.0"
description = "Minimal discovery rules for ROS1 workspaces (info-only)"

[[rules]]
id = "ros1-header-ros"
name = "ROS1 core header (discovery)"
description = "Detect use of ROS1 core header includes for investigation purposes"
severity = "info"
category = "discovery"
target = "cpp"

[rules.match]
type = "include"
pattern = "ros/ros.h"

[rules.output]
message = "found include: ros/ros.h (investigation)"

[[rules]]
id = "ros1-nodehandle"
name = "ROS1 NodeHandle (discovery)"
description = "Detect use of NodeHandle includes"
severity = "info"
category = "discovery"
target = "cpp"

[rules.match]
type = "include"
pattern = "ros/node_handle.h"

[rules.output]
message = "found include: ros/node_handle.h (investigation)"

[[rules]]
id = "ros1-init-spin"
name = "ros::init / ros::spin usage"
description = "Detect calls to ros::init and ros::spin"
severity = "info"
category = "discovery"
target = "cpp"

[rules.match]
type = "regex"
pattern = "\\bros::(init|spin)\\b"

[rules.output]
message = "found ros::init/ros::spin usage (investigation)"

[[rules]]
id = "roscpp-dep"
name = "roscpp dependency in package.xml"
description = "Detect roscpp declared as dependency in package.xml"
severity = "info"
category = "discovery"
target = "package_xml"

[rules.match]
type = "dependency"
pattern = "roscpp"

[rules.output]
message = "dependency roscpp found in package.xml (investigation)"

[[rules]]
id = "rospy-dep"
name = "rospy dependency in package.xml"
description = "Detect rospy declared as dependency in package.xml"
severity = "info"
category = "discovery"
target = "package_xml"

[rules.match]
type = "dependency"
pattern = "rospy"

[rules.output]
message = "dependency rospy found in package.xml (investigation)"

[[rules]]
id = "tf-legacy"
name = "legacy TF usage"
description = "Detect usage of legacy TF includes/names"
severity = "info"
category = "discovery"
target = "cpp"

[rules.match]
type = "regex"
pattern = "\\btf/|::tf\\b"

[rules.output]
message = "found tf (legacy) usage (investigation)"

[[rules]]
id = "rosparam-usage"
name = "ros::param / getParam / setParam usage"
description = "Detect parameter API usage patterns"
severity = "info"
category = "discovery"
target = "cpp"

[rules.match]
type = "regex"
pattern = "ros::param|getParam|setParam"

[rules.output]
message = "found parameter API usage (investigation)"

[[rules]]
id = "ros-logging"
name = "ROS logging macros"
description = "Detect ROS logging macro usage (ROS_INFO/WARN/ERROR/DEBUG)"
severity = "info"
category = "discovery"
target = "cpp"

[rules.match]
type = "regex"
pattern = "\\bROS_(INFO|WARN|ERROR|DEBUG)\\b"

[rules.output]
message = "found ROS logging macro usage (investigation)"

[[rules]]
id = "topic-api"
name = "advertise/subscribe usage"
description = "Detect advertise/subscribe calls on publishers/subscribers"
severity = "info"
category = "discovery"
target = "cpp"

[rules.match]
type = "regex"
pattern = "\\.advertise\\(|\\.subscribe\\("

[rules.output]
message = "found advertise/subscribe usage (investigation)"

[[rules]]
id = "service-api"
name = "service advertise/client usage"
description = "Detect service advertise / client usage"
severity = "info"
category = "discovery"
target = "cpp"

[rules.match]
type = "regex"
pattern = "\\.advertiseService\\(|serviceClient\\("

[rules.output]
message = "found service API usage (investigation)"

[[rules]]
id = "nodelet-usage"
name = "nodelet usage"
description = "Detect nodelet-related usage"
severity = "info"
category = "discovery"
target = "cpp"

[rules.match]
type = "regex"
pattern = "nodelet"

[rules.output]
message = "found nodelet usage (investigation)"
